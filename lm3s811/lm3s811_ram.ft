HEX

0 SCR !
-1 BLOCK# !

VARIABLE TICK
VARIABLE TICK-SEMA

: SYSTICK-IRQ   1 TICK +!   0F TICK @ AND 0= TICK-SEMA ! ;I

PT: SLEEPER
    BEGIN
        BEGIN TICK-SEMA @ 0= ?YIELD
        0 TICK-SEMA !
        TICK @ .
    AGAIN
;PT

: SYSTICK-ENABLE
    ['] SYSTICK-IRQ IVT 0E CELLS + !
    0 TICK !
    0 TICK-SEMA !
    4C4B40 STRELOAD !
    7 STCTRL !
;

: RUNNER BEGIN WFI SLEEPER AGAIN ;

ABORT
